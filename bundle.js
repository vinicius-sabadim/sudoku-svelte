var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function l(e){e.forEach(t)}function r(e){return"function"==typeof e}function o(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function c(e,t){e.appendChild(t)}function i(e,t,n){e.insertBefore(t,n||null)}function a(e){e.parentNode.removeChild(e)}function s(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function u(e){return document.createElement(e)}function f(e){return document.createTextNode(e)}function d(){return f(" ")}function h(e,t,n,l){return e.addEventListener(t,n,l),()=>e.removeEventListener(t,n,l)}let p;function v(e){p=e}function m(){const e=p;return(t,n)=>{const l=e.$$.callbacks[t];if(l){const r=function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(t,n);l.slice().forEach(t=>{t.call(e,r)})}}}const g=[],$=Promise.resolve();let y=!1;const k=[],b=[],x=[];function N(e){b.push(e)}function D(){const e=new Set;do{for(;g.length;){const e=g.shift();v(e),V(e.$$)}for(;k.length;)k.shift()();for(;b.length;){const t=b.pop();e.has(t)||(t(),e.add(t))}}while(g.length);for(;x.length;)x.pop()();y=!1}function V(e){e.fragment&&(e.update(e.dirty),l(e.before_render),e.fragment.p(e.dirty,e.ctx),e.dirty=null,e.after_render.forEach(N))}let _;function j(){_={remaining:0,callbacks:[]}}function q(){_.remaining||l(_.callbacks)}function E(e){_.callbacks.push(e)}function C(e,n,o){const{fragment:c,on_mount:i,on_destroy:a,after_render:s}=e.$$;c.m(n,o),N(()=>{const n=i.map(t).filter(r);a?a.push(...n):l(n),e.$$.on_mount=[]}),s.forEach(N)}function I(e,t){e.$$.dirty||(g.push(e),y||(y=!0,$.then(D)),e.$$.dirty=n()),e.$$.dirty[t]=!0}function w(t,r,o,c,i,a){const s=p;v(t);const u=r.props||{},f=t.$$={fragment:null,ctx:null,props:a,update:e,not_equal:i,bound:n(),on_mount:[],on_destroy:[],before_render:[],after_render:[],context:new Map(s?s.$$.context:[]),callbacks:n(),dirty:null};let d=!1;var h;f.ctx=o?o(t,u,(e,n)=>{f.ctx&&i(f.ctx[e],f.ctx[e]=n)&&(f.bound[e]&&f.bound[e](n),d&&I(t,e))}):u,f.update(),d=!0,l(f.before_render),f.fragment=c(f.ctx),r.target&&(r.hydrate?f.fragment.l((h=r.target,Array.from(h.childNodes))):f.fragment.c(),r.intro&&t.$$.fragment.i&&t.$$.fragment.i(),C(t,r.target,r.anchor),D()),v(s)}class B{$destroy(){var t,n;n=!0,(t=this).$$&&(l(t.$$.on_destroy),t.$$.fragment.d(n),t.$$.on_destroy=t.$$.fragment=null,t.$$.ctx={}),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}function M(e,t,n){const l=Object.create(e);return l.level=t[n],l}function A(e){var t,n,l,r,o=e.levelText[e.level];function s(){return e.click_handler(e)}return{c(){t=u("li"),n=f(o),t.className=l=(e.level===e.selectedDifficult?"active":"")+" svelte-rk9qj4",r=h(t,"click",s)},m(e,l){i(e,t,l),c(t,n)},p(n,r){e=r,n.selectedDifficult&&l!==(l=(e.level===e.selectedDifficult?"active":"")+" svelte-rk9qj4")&&(t.className=l)},d(e){e&&a(t),r()}}}function O(e){var t;return{c(){(t=u("p")).textContent="Victory :)",t.className="victory svelte-rk9qj4"},m(e,n){i(e,t,n)},d(e){e&&a(t)}}}function P(t){for(var n,l,r,o,f,h,p,v=t.levels,m=[],g=0;g<v.length;g+=1)m[g]=A(M(t,v,g));var $=t.isVictory&&O();return{c(){n=u("div"),(l=u("h1")).textContent="Change level",r=d(),o=u("ul");for(var e=0;e<m.length;e+=1)m[e].c();f=d(),(h=u("div")).innerHTML='<h2 class="svelte-rk9qj4">Hints</h2>\n\t\t\t    <ul><li class="svelte-rk9qj4">Use the number 0 to erase a cell.</li>\n\t\t\t      <li class="svelte-rk9qj4">Use ctrl + number to fill a cell using a pencil.</li></ul>',p=d(),$&&$.c(),l.className="svelte-rk9qj4",o.className="level-menu svelte-rk9qj4",h.className="hint-container svelte-rk9qj4",n.className="container svelte-rk9qj4"},m(e,t){i(e,n,t),c(n,l),c(n,r),c(n,o);for(var a=0;a<m.length;a+=1)m[a].m(o,null);c(n,f),c(n,h),c(n,p),$&&$.m(n,null)},p(e,t){if(e.levels||e.selectedDifficult||e.levelText){v=t.levels;for(var l=0;l<v.length;l+=1){const n=M(t,v,l);m[l]?m[l].p(e,n):(m[l]=A(n),m[l].c(),m[l].m(o,null))}for(;l<m.length;l+=1)m[l].d(1);m.length=v.length}t.isVictory?$||(($=O()).c(),$.m(n,null)):$&&($.d(1),$=null)},i:e,o:e,d(e){e&&a(n),s(m,e),$&&$.d()}}}function G(e,t,n){let{isVictory:l,selectedDifficult:r}=t;const o=m(),c=e=>{o("change-difficult",e)};return e.$set=(e=>{"isVictory"in e&&n("isVictory",l=e.isVictory),"selectedDifficult"in e&&n("selectedDifficult",r=e.selectedDifficult)}),{isVictory:l,selectedDifficult:r,handleChange:c,levels:["easy","medium","hard","veryHard","insane"],levelText:{easy:"Easy",medium:"Medium",hard:"Hard",veryHard:"Very hard",insane:"Insane"},click_handler:function({level:e}){return c(e)}}}class W extends B{constructor(e){super(),w(this,e,G,P,o,["isVictory","selectedDifficult"])}}function H(e,t,n){const l=Object.create(e);return l.option=t[n],l}function T(e){for(var t,n=e.options,l=[],r=0;r<n.length;r+=1)l[r]=S(H(e,n,r));return{c(){t=u("ul");for(var e=0;e<l.length;e+=1)l[e].c();t.className="pencil-container svelte-1k8fof0"},m(e,n){i(e,t,n);for(var r=0;r<l.length;r+=1)l[r].m(t,null)},p(e,r){if(e.options||e.cell){n=r.options;for(var o=0;o<n.length;o+=1){const c=H(r,n,o);l[o]?l[o].p(e,c):(l[o]=S(c),l[o].c(),l[o].m(t,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=n.length}},d(e){e&&a(t),s(l,e)}}}function S(e){var t,n,l,r,o=e.option;return{c(){t=u("li"),n=f(o),l=d(),t.className=r=`option option${e.option} ${e.cell.pencil.has(e.option)?"visibleOption":""} `+" svelte-1k8fof0"},m(e,r){i(e,t,r),c(t,n),c(t,l)},p(e,n){e.cell&&r!==(r=`option option${n.option} ${n.cell.pencil.has(n.option)?"visibleOption":""} `+" svelte-1k8fof0")&&(t.className=r)},d(e){e&&a(t)}}}function L(t){var n,r,o,s,f,p,v=!t.cell.value&&T(t);return{c(){var e,l,c,i;n=u("div"),r=u("input"),f=d(),v&&v.c(),r.className=o=(t.cell.error?"hasError":"")+" svelte-1k8fof0",r.disabled=s=t.cell.readonly,e=r,l="type",null==(c="text")?e.removeAttribute(l):e.setAttribute(l,c),n.className="container svelte-1k8fof0",p=[h(r,"input",t.input_input_handler),h(r,"keydown",(i=t.handleChange,function(e){return e.preventDefault(),i.call(this,e)})),h(n,"click",t.putFocus)]},m(e,l){i(e,n,l),c(n,r),r.value=t.cell.value,c(n,f),v&&v.m(n,null)},p(e,t){e.cell&&r.value!==t.cell.value&&(r.value=t.cell.value),e.cell&&o!==(o=(t.cell.error?"hasError":"")+" svelte-1k8fof0")&&(r.className=o),e.cell&&s!==(s=t.cell.readonly)&&(r.disabled=s),t.cell.value?v&&(v.d(1),v=null):v?v.p(e,t):((v=T(t)).c(),v.m(n,null))},i:e,o:e,d(e){e&&a(n),v&&v.d(),l(p)}}}function F(e,t,n){let{cell:l}=t;const r=m();return e.$set=(e=>{"cell"in e&&n("cell",l=e.cell)}),{cell:l,options:[1,2,3,4,5,6,7,8,9],handleChange:e=>{const t=parseInt(e.key),n=e.ctrlKey;Number.isInteger(t)&&r(n?"pencil":"pen",{value:parseInt(t,10),position:l.position})},putFocus:e=>{e.currentTarget.querySelector("input").focus()},input_input_handler:function(){l.value=this.value,n("cell",l)}}}class U extends B{constructor(e){super(),w(this,e,F,L,o,["cell"])}}const z=[Array(2).fill([1,1,2,2]),Array(2).fill([3,3,4,4])].flat(2),K=[Array(3).fill([1,1,1,2,2,2,3,3,3]),Array(3).fill([4,4,4,5,5,5,6,6,6]),Array(3).fill([7,7,7,8,8,8,9,9,9])].flat(2),J=(e=3)=>{return Array(3===e?81:16).fill(0)},Q=e=>{for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e},R=(e,t=3)=>{const n=3===t?9:4,l=[];let r=0,o=e[r],c=Q([1,2,3,4,5,6,7,8,9]),i=0;for(;ne(e);)0===o?te(e,r,c[i],t)&&i<n?(e[r]=c[i],l.push(r),c=Q([1,2,3,4,5,6,7,8,9]),i=-1,o=e[r+=1]):i>n-1&&(e[r]=0,r=l.pop(),i=c.indexOf(e[r]),e[r]=0):(o=e[r+=1],c=Q([1,2,3,4,5,6,7,8,9]),i=-1),i+=1;return e},X=(e,t=3)=>{const n=3===t?K:z;return e.map((e,t)=>({value:e,block:n[t],position:t,readonly:!!e,pencil:new Set}))},Y=e=>e.reduce((e,t)=>{const n=t.block-1;return e[n]?e[n].push(t):e[n]=[t],e},[]),Z={easy:62,medium:53,hard:44,veryHard:35,insane:26},ee=(e,t)=>{const n=new Set;for(;n.size!==81-Z[e];){const e=Math.floor(81*Math.random());n.add(e)}for(const e of n)t[e]=null;return t},te=(e,t,n,l=3)=>{const r=new Set,o=3===l?9:4,c=3===l?K:z,i=Math.floor(t/o);e.forEach((e,t)=>{Math.floor(t/o)===i&&r.add(e)});const a=t%o;e.forEach((e,t)=>{Math.floor(t%o)===a&&r.add(e)});const s=c[t];return e.forEach((e,t)=>{c[t]===s&&r.add(e)}),!r.has(n)},ne=e=>0!==e.filter(e=>0===e).length,le=e=>e.filter(e=>e.error).length,re=(e,t)=>e.filter(e=>null===e.value).length+t;function oe(e,t,n){const l=Object.create(e);return l.cell=t[n],l}function ce(e,t,n){const l=Object.create(e);return l.block=t[n],l}function ie(e){var t,n,l=new U({props:{cell:e.cell}});return l.$on("pen",e.handlePen),l.$on("pencil",e.handlePencil),{c(){t=u("div"),l.$$.fragment.c(),t.className="cell svelte-1lnq6b1"},m(e,r){i(e,t,r),C(l,t,null),n=!0},p(e,t){var n={};e.groupedGrid&&(n.cell=t.cell),l.$set(n)},i(e){n||(l.$$.fragment.i(e),n=!0)},o(e){l.$$.fragment.o(e),n=!1},d(e){e&&a(t),l.$destroy()}}}function ae(e){for(var t,n,l,r=e.block,o=[],f=0;f<r.length;f+=1)o[f]=ie(oe(e,r,f));function h(e,t,n){o[e]&&(t&&E(()=>{o[e].d(t),o[e]=null}),o[e].o(n))}return{c(){t=u("div");for(var e=0;e<o.length;e+=1)o[e].c();n=d(),t.className="block svelte-1lnq6b1"},m(e,r){i(e,t,r);for(var a=0;a<o.length;a+=1)o[a].m(t,null);c(t,n),l=!0},p(e,l){if(e.groupedGrid||e.handlePen||e.handlePencil){r=l.block;for(var c=0;c<r.length;c+=1){const i=oe(l,r,c);o[c]?(o[c].p(e,i),o[c].i(1)):(o[c]=ie(i),o[c].c(),o[c].i(1),o[c].m(t,n))}for(j();c<o.length;c+=1)h(c,1,1);q()}},i(e){if(!l){for(var t=0;t<r.length;t+=1)o[t].i();l=!0}},o(e){o=o.filter(Boolean);for(let e=0;e<o.length;e+=1)h(e,0,0);l=!1},d(e){e&&a(t),s(o,e)}}}function se(e){var t,n,l,r,o=new W({props:{isVictory:e.isVictory,selectedDifficult:e.selectedDifficult}});o.$on("change-difficult",e.handleChangeDifficult);for(var f=e.groupedGrid,h=[],p=0;p<f.length;p+=1)h[p]=ae(ce(e,f,p));function v(e,t,n){h[e]&&(t&&E(()=>{h[e].d(t),h[e]=null}),h[e].o(n))}return{c(){t=u("div"),o.$$.fragment.c(),n=d(),l=u("div");for(var e=0;e<h.length;e+=1)h[e].c();l.className="grid svelte-1lnq6b1",t.className="container svelte-1lnq6b1"},m(e,a){i(e,t,a),C(o,t,null),c(t,n),c(t,l);for(var s=0;s<h.length;s+=1)h[s].m(l,null);r=!0},p(e,t){var n={};if(e.isVictory&&(n.isVictory=t.isVictory),e.selectedDifficult&&(n.selectedDifficult=t.selectedDifficult),o.$set(n),e.groupedGrid||e.handlePen||e.handlePencil){f=t.groupedGrid;for(var r=0;r<f.length;r+=1){const n=ce(t,f,r);h[r]?(h[r].p(e,n),h[r].i(1)):(h[r]=ae(n),h[r].c(),h[r].i(1),h[r].m(l,null))}for(j();r<h.length;r+=1)v(r,1,1);q()}},i(e){if(!r){o.$$.fragment.i(e);for(var t=0;t<f.length;t+=1)h[t].i();r=!0}},o(e){o.$$.fragment.o(e),h=h.filter(Boolean);for(let e=0;e<h.length;e+=1)v(e,0,0);r=!1},d(e){e&&a(t),o.$destroy(),s(h,e)}}}function ue(e,t,n){let l,r,o="hard";const c=e=>{const t=J(3),c=R(t,3);l=ee(o,c),n("gridWithBlockInfo",r=X(l,3))};let i,a,s,u;return c(),e.$$.update=((e={gridWithBlockInfo:1,errors:1,missingValues:1})=>{e.gridWithBlockInfo&&n("groupedGrid",i=Y(r)),e.gridWithBlockInfo&&n("errors",a=le(r)),(e.gridWithBlockInfo||e.errors)&&n("missingValues",s=re(r,a)),e.missingValues&&n("isVictory",u=0===s)}),{selectedDifficult:o,handlePen:({detail:{value:e,position:t}})=>{const o=te(l,t,e);n("gridWithBlockInfo",r=r.map(n=>n.position!==t?n:{...n,value:0!==e?e:null,error:!o})),l[t]=e},handlePencil:({detail:{value:e,position:t}})=>{0!==e&&n("gridWithBlockInfo",r=r.map(n=>n.position!==t?n:(n.pencil.has(e)?n.pencil.delete(e):n.pencil.add(e),n)))},handleChangeDifficult:({detail:e})=>{n("selectedDifficult",o=e),c()},groupedGrid:i,isVictory:u}}return new class extends B{constructor(e){super(),w(this,e,ue,se,o,[])}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
