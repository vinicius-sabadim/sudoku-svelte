var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function l(e){e.forEach(t)}function i(e){return"function"==typeof e}function r(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function o(e,t){e.appendChild(t)}function c(e,t,n){e.insertBefore(t,n||null)}function a(e){e.parentNode.removeChild(e)}function s(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function u(e){return document.createElement(e)}function h(e){return document.createTextNode(e)}function f(){return h(" ")}function d(e,t,n,l){return e.addEventListener(t,n,l),()=>e.removeEventListener(t,n,l)}let g;function v(e){g=e}function p(){const e=g;return(t,n)=>{const l=e.$$.callbacks[t];if(l){const i=function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(t,n);l.slice().forEach(t=>{t.call(e,i)})}}}const m=[],$=Promise.resolve();let y=!1;const k=[],V=[],b=[];function w(e){V.push(e)}function P(){const e=new Set;do{for(;m.length;){const e=m.shift();v(e),N(e.$$)}for(;k.length;)k.shift()();for(;V.length;){const t=V.pop();e.has(t)||(t(),e.add(t))}}while(m.length);for(;b.length;)b.pop()();y=!1}function N(e){e.fragment&&(e.update(e.dirty),l(e.before_render),e.fragment.p(e.dirty,e.ctx),e.dirty=null,e.after_render.forEach(w))}let x;function D(){x={remaining:0,callbacks:[]}}function _(){x.remaining||l(x.callbacks)}function C(e){x.callbacks.push(e)}function E(e,n,r){const{fragment:o,on_mount:c,on_destroy:a,after_render:s}=e.$$;o.m(n,r),w(()=>{const n=c.map(t).filter(i);a?a.push(...n):l(n),e.$$.on_mount=[]}),s.forEach(w)}function A(e,t){e.$$.dirty||(m.push(e),y||(y=!0,$.then(P)),e.$$.dirty=n()),e.$$.dirty[t]=!0}function O(t,i,r,o,c,a){const s=g;v(t);const u=i.props||{},h=t.$$={fragment:null,ctx:null,props:a,update:e,not_equal:c,bound:n(),on_mount:[],on_destroy:[],before_render:[],after_render:[],context:new Map(s?s.$$.context:[]),callbacks:n(),dirty:null};let f=!1;var d;h.ctx=r?r(t,u,(e,n)=>{h.ctx&&c(h.ctx[e],h.ctx[e]=n)&&(h.bound[e]&&h.bound[e](n),f&&A(t,e))}):u,h.update(),f=!0,l(h.before_render),h.fragment=o(h.ctx),i.target&&(i.hydrate?h.fragment.l((d=i.target,Array.from(d.childNodes))):h.fragment.c(),i.intro&&t.$$.fragment.i&&t.$$.fragment.i(),E(t,i.target,i.anchor),P()),v(s)}class I{$destroy(){var t,n;n=!0,(t=this).$$&&(l(t.$$.on_destroy),t.$$.fragment.d(n),t.$$.on_destroy=t.$$.fragment=null,t.$$.ctx={}),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}function B(e,t,n){const l=Object.create(e);return l.level=t[n],l}function H(e){var t,n,l,i,r=e.levelText[e.level];function s(){return e.click_handler(e)}return{c(){t=u("li"),n=h(r),t.className=l=(e.level===e.selectedDifficult?"active":"")+" svelte-k3hw74",i=d(t,"click",s)},m(e,l){c(e,t,l),o(t,n)},p(n,i){e=i,n.selectedDifficult&&l!==(l=(e.level===e.selectedDifficult?"active":"")+" svelte-k3hw74")&&(t.className=l)},d(e){e&&a(t),i()}}}function M(e){var t;return{c(){(t=u("p")).textContent="Victory :)",t.className="victory svelte-k3hw74"},m(e,n){c(e,t,n)},d(e){e&&a(t)}}}function G(t){for(var n,l,i,r,h,d,g,v=t.levels,p=[],m=0;m<v.length;m+=1)p[m]=H(B(t,v,m));var $=t.isVictory&&M();return{c(){n=u("div"),(l=u("h1")).textContent="Change level",i=f(),r=u("ul");for(var e=0;e<p.length;e+=1)p[e].c();h=f(),(d=u("div")).innerHTML='<h2 class="svelte-k3hw74">Hints</h2>\n\t\t\t    <ul><li class="svelte-k3hw74">Click on a cell to highlight the same values.</li>\n\t\t\t      <li class="svelte-k3hw74">Arrow keys navigate through the cells.</li>\n\t\t\t      <li class="svelte-k3hw74">Number 0 erase a cell.</li>\n\t\t\t      <li class="svelte-k3hw74">Ctrl + number fill a cell using a pencil.</li></ul>',g=f(),$&&$.c(),l.className="svelte-k3hw74",r.className="level-menu svelte-k3hw74",d.className="hint-container svelte-k3hw74",n.className="container svelte-k3hw74"},m(e,t){c(e,n,t),o(n,l),o(n,i),o(n,r);for(var a=0;a<p.length;a+=1)p[a].m(r,null);o(n,h),o(n,d),o(n,g),$&&$.m(n,null)},p(e,t){if(e.levels||e.selectedDifficult||e.levelText){v=t.levels;for(var l=0;l<v.length;l+=1){const n=B(t,v,l);p[l]?p[l].p(e,n):(p[l]=H(n),p[l].c(),p[l].m(r,null))}for(;l<p.length;l+=1)p[l].d(1);p.length=v.length}t.isVictory?$||(($=M()).c(),$.m(n,null)):$&&($.d(1),$=null)},i:e,o:e,d(e){e&&a(n),s(p,e),$&&$.d()}}}function W(e,t,n){let{isVictory:l,selectedDifficult:i}=t;const r=p(),o=e=>{r("change-difficult",e)};return e.$set=(e=>{"isVictory"in e&&n("isVictory",l=e.isVictory),"selectedDifficult"in e&&n("selectedDifficult",i=e.selectedDifficult)}),{isVictory:l,selectedDifficult:i,handleChange:o,levels:["easy","medium","hard","veryHard","insane"],levelText:{easy:"Easy",medium:"Medium",hard:"Hard",veryHard:"Very hard",insane:"Insane"},click_handler:function({level:e}){return o(e)}}}class j extends I{constructor(e){super(),O(this,e,W,G,r,["isVictory","selectedDifficult"])}}function q(e,t,n){const l=Object.create(e);return l.option=t[n],l}function T(e){for(var t,n=e.options,l=[],i=0;i<n.length;i+=1)l[i]=L(q(e,n,i));return{c(){t=u("ul");for(var e=0;e<l.length;e+=1)l[e].c();t.className="pencil-container svelte-17nr28p"},m(e,n){c(e,t,n);for(var i=0;i<l.length;i+=1)l[i].m(t,null)},p(e,i){if(e.options||e.cell){n=i.options;for(var r=0;r<n.length;r+=1){const o=q(i,n,r);l[r]?l[r].p(e,o):(l[r]=L(o),l[r].c(),l[r].m(t,null))}for(;r<l.length;r+=1)l[r].d(1);l.length=n.length}},d(e){e&&a(t),s(l,e)}}}function L(e){var t,n,l,i,r=e.option;return{c(){t=u("li"),n=h(r),l=f(),t.className=i=`option option${e.option} ${e.cell.pencil.has(e.option)?"visibleOption":""}`+" svelte-17nr28p"},m(e,i){c(e,t,i),o(t,n),o(t,l)},p(e,n){e.cell&&i!==(i=`option option${n.option} ${n.cell.pencil.has(n.option)?"visibleOption":""}`+" svelte-17nr28p")&&(t.className=i)},d(e){e&&a(t)}}}function S(t){var n,i,r,s,h,g,v=!t.cell.value&&T(t);return{c(){var e,l,o;n=u("div"),i=u("input"),s=f(),v&&v.c(),i.disabled=r=t.cell.readonly,e=i,l="type",null==(o="text")?e.removeAttribute(l):e.setAttribute(l,o),i.className="svelte-17nr28p",n.className=h=`container\n  ${t.cell.readonly?"readOnly":"notReadOnly"}\n  ${t.cell.error?"hasError":""}\n  ${t.cell.position===t.activePosition?"keyboardActive":""}\n  ${t.highlightValue&&t.cell.value===t.highlightValue?"highlight":""}`+" svelte-17nr28p",g=[d(i,"input",t.input_input_handler),d(n,"click",t.cellClicked)]},m(e,l){c(e,n,l),o(n,i),i.value=t.cell.value,o(n,s),v&&v.m(n,null)},p(e,t){e.cell&&i.value!==t.cell.value&&(i.value=t.cell.value),e.cell&&r!==(r=t.cell.readonly)&&(i.disabled=r),t.cell.value?v&&(v.d(1),v=null):v?v.p(e,t):((v=T(t)).c(),v.m(n,null)),(e.cell||e.activePosition||e.highlightValue)&&h!==(h=`container\n  ${t.cell.readonly?"readOnly":"notReadOnly"}\n  ${t.cell.error?"hasError":""}\n  ${t.cell.position===t.activePosition?"keyboardActive":""}\n  ${t.highlightValue&&t.cell.value===t.highlightValue?"highlight":""}`+" svelte-17nr28p")&&(n.className=h)},i:e,o:e,d(e){e&&a(n),v&&v.d(),l(g)}}}function R(e,t,n){let{cell:l,activePosition:i,highlightValue:r}=t;const o=p();return e.$set=(e=>{"cell"in e&&n("cell",l=e.cell),"activePosition"in e&&n("activePosition",i=e.activePosition),"highlightValue"in e&&n("highlightValue",r=e.highlightValue)}),{cell:l,activePosition:i,highlightValue:r,options:[1,2,3,4,5,6,7,8,9],cellClicked:e=>{e.currentTarget.querySelector("input").focus(),o("highlight",l.value),o("change-navigation",l.position)},input_input_handler:function(){l.value=this.value,n("cell",l)}}}class z extends I{constructor(e){super(),O(this,e,R,S,r,["cell","activePosition","highlightValue"])}}const K=[Array(2).fill([1,1,2,2]),Array(2).fill([3,3,4,4])].flat(2),U=[Array(3).fill([1,1,1,2,2,2,3,3,3]),Array(3).fill([4,4,4,5,5,5,6,6,6]),Array(3).fill([7,7,7,8,8,8,9,9,9])].flat(2),F=(e=3)=>{return Array(3===e?81:16).fill(0)},J=e=>{for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e},Q=(e,t=3)=>{const n=3===t?9:4,l=[];let i=0,r=e[i],o=J([1,2,3,4,5,6,7,8,9]),c=0;for(;ne(e);)0===r?te(e,i,o[c],t)&&c<n?(e[i]=o[c],l.push(i),o=J([1,2,3,4,5,6,7,8,9]),c=-1,r=e[i+=1]):c>n-1&&(e[i]=0,i=l.pop(),c=o.indexOf(e[i]),e[i]=0):(r=e[i+=1],o=J([1,2,3,4,5,6,7,8,9]),c=-1),c+=1;return e},X=(e,t=3)=>{const n=3===t?U:K;return e.map((e,t)=>({value:e,block:n[t],position:t,readonly:!!e,pencil:new Set}))},Y=e=>e.reduce((e,t)=>{const n=t.block-1;return e[n]?e[n].push(t):e[n]=[t],e},[]),Z={easy:62,medium:53,hard:44,veryHard:35,insane:26},ee=(e,t)=>{const n=new Set;for(;n.size!==81-Z[e];){const e=Math.floor(81*Math.random());n.add(e)}for(const e of n)t[e]=null;return t},te=(e,t,n,l=3)=>{const i=new Set,r=3===l?9:4,o=3===l?U:K,c=Math.floor(t/r);e.forEach((e,t)=>{Math.floor(t/r)===c&&i.add(e)});const a=t%r;e.forEach((e,t)=>{Math.floor(t%r)===a&&i.add(e)});const s=o[t];return e.forEach((e,t)=>{o[t]===s&&i.add(e)}),!i.has(n)},ne=e=>0!==e.filter(e=>0===e).length,le=e=>e.filter(e=>e.error).length,ie=(e,t)=>e.filter(e=>null===e.value).length+t,re=(e,t)=>{const n=parseInt(e,10);return"ArrowDown"===e&&t<72?[!0,"down"]:"ArrowUp"===e&&t>8?[!0,"up"]:"ArrowLeft"===e&&t%9>0?[!0,"left"]:"ArrowRight"===e&&t%9<8?[!0,"right"]:Number.isInteger(n)?[!0,"digit"]:[!1,null]},oe=(e,t)=>"down"===t?e+9:"up"===t?e-9:"left"===t?e-1:"right"===t?e+1:void 0;function ce(e,t,n){const l=Object.create(e);return l.cell=t[n],l}function ae(e,t,n){const l=Object.create(e);return l.block=t[n],l}function se(e){var t,n,l=new z({props:{cell:e.cell,activePosition:e.activePosition,highlightValue:e.highlightValue}});return l.$on("change-navigation",e.handleChangeNavigation),l.$on("highlight",e.handleHighlight),l.$on("pen",e.handlePen),l.$on("pencil",e.handlePencil),{c(){t=u("div"),l.$$.fragment.c(),t.className="cell svelte-raq76k"},m(e,i){c(e,t,i),E(l,t,null),n=!0},p(e,t){var n={};e.groupedGrid&&(n.cell=t.cell),e.activePosition&&(n.activePosition=t.activePosition),e.highlightValue&&(n.highlightValue=t.highlightValue),l.$set(n)},i(e){n||(l.$$.fragment.i(e),n=!0)},o(e){l.$$.fragment.o(e),n=!1},d(e){e&&a(t),l.$destroy()}}}function ue(e){for(var t,n,l,i=e.block,r=[],h=0;h<i.length;h+=1)r[h]=se(ce(e,i,h));function d(e,t,n){r[e]&&(t&&C(()=>{r[e].d(t),r[e]=null}),r[e].o(n))}return{c(){t=u("div");for(var e=0;e<r.length;e+=1)r[e].c();n=f(),t.className="block svelte-raq76k"},m(e,i){c(e,t,i);for(var a=0;a<r.length;a+=1)r[a].m(t,null);o(t,n),l=!0},p(e,l){if(e.groupedGrid||e.activePosition||e.highlightValue||e.handleChangeNavigation||e.handleHighlight||e.handlePen||e.handlePencil){i=l.block;for(var o=0;o<i.length;o+=1){const c=ce(l,i,o);r[o]?(r[o].p(e,c),r[o].i(1)):(r[o]=se(c),r[o].c(),r[o].i(1),r[o].m(t,n))}for(D();o<r.length;o+=1)d(o,1,1);_()}},i(e){if(!l){for(var t=0;t<i.length;t+=1)r[t].i();l=!0}},o(e){r=r.filter(Boolean);for(let e=0;e<r.length;e+=1)d(e,0,0);l=!1},d(e){e&&a(t),s(r,e)}}}function he(e){var t,n,l,i,r=new j({props:{isVictory:e.isVictory,selectedDifficult:e.selectedDifficult}});r.$on("change-difficult",e.handleChangeDifficult);for(var h=e.groupedGrid,d=[],g=0;g<h.length;g+=1)d[g]=ue(ae(e,h,g));function v(e,t,n){d[e]&&(t&&C(()=>{d[e].d(t),d[e]=null}),d[e].o(n))}return{c(){t=u("div"),r.$$.fragment.c(),n=f(),l=u("div");for(var e=0;e<d.length;e+=1)d[e].c();l.className="grid svelte-raq76k",t.className="container svelte-raq76k"},m(e,a){c(e,t,a),E(r,t,null),o(t,n),o(t,l);for(var s=0;s<d.length;s+=1)d[s].m(l,null);i=!0},p(e,t){var n={};if(e.isVictory&&(n.isVictory=t.isVictory),e.selectedDifficult&&(n.selectedDifficult=t.selectedDifficult),r.$set(n),e.groupedGrid||e.activePosition||e.highlightValue||e.handleChangeNavigation||e.handleHighlight||e.handlePen||e.handlePencil){h=t.groupedGrid;for(var i=0;i<h.length;i+=1){const n=ae(t,h,i);d[i]?(d[i].p(e,n),d[i].i(1)):(d[i]=ue(n),d[i].c(),d[i].i(1),d[i].m(l,null))}for(D();i<d.length;i+=1)v(i,1,1);_()}},i(e){if(!i){r.$$.fragment.i(e);for(var t=0;t<h.length;t+=1)d[t].i();i=!0}},o(e){r.$$.fragment.o(e),d=d.filter(Boolean);for(let e=0;e<d.length;e+=1)v(e,0,0);i=!1},d(e){e&&a(t),r.$destroy(),s(d,e)}}}function fe(e,t,n){let l,i,r="hard",o=0,c=null;const a=e=>{const t=F(3),o=Q(t,3);l=ee(r,o),n("gridWithBlockInfo",i=X(l,3))},s=({detail:{value:e,position:t}})=>{const r=te(l,t,e);n("gridWithBlockInfo",i=i.map(n=>n.position!==t?n:{...n,value:0!==e?e:null,error:0!==e&&!r})),l[t]=e},u=({detail:{value:e,position:t}})=>{0!==e&&n("gridWithBlockInfo",i=i.map(n=>{if(n.position!==t)return n;return n.pencil.has(e)?n.pencil.delete(e):n.pencil.add(e),n}))};let h,f,d,g;return a(),window.addEventListener("keydown",e=>{e.preventDefault();const{key:t,ctrlKey:l}=e,[r,c]=re(t,o);if(r)if("digit"!==c)n("activePosition",o=oe(o,c));else{if(i[o].readonly)return;const e={detail:{value:parseInt(t,10),position:o}};l?u(e):s(e)}}),e.$$.update=((e={gridWithBlockInfo:1,errors:1,missingValues:1})=>{e.gridWithBlockInfo&&n("groupedGrid",h=Y(i)),e.gridWithBlockInfo&&n("errors",f=le(i)),(e.gridWithBlockInfo||e.errors)&&n("missingValues",d=ie(i,f)),e.missingValues&&n("isVictory",g=0===d)}),{selectedDifficult:r,activePosition:o,highlightValue:c,handlePen:s,handlePencil:u,handleChangeDifficult:({detail:e})=>{n("selectedDifficult",r=e),a()},handleChangeNavigation:({detail:e})=>{n("activePosition",o=e)},handleHighlight:({detail:e})=>{n("highlightValue",c=c===e?null:e)},groupedGrid:h,isVictory:g}}return new class extends I{constructor(e){super(),O(this,e,fe,he,r,[])}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
