var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function l(e){e.forEach(t)}function i(e){return"function"==typeof e}function r(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function o(e,t){e.appendChild(t)}function c(e,t,n){e.insertBefore(t,n||null)}function s(e){e.parentNode.removeChild(e)}function a(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function u(e){return document.createElement(e)}function f(e){return document.createTextNode(e)}function d(){return f(" ")}function h(e,t,n,l){return e.addEventListener(t,n,l),()=>e.removeEventListener(t,n,l)}let v;function p(e){v=e}function g(){const e=v;return(t,n)=>{const l=e.$$.callbacks[t];if(l){const i=function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(t,n);l.slice().forEach(t=>{t.call(e,i)})}}}const m=[],$=Promise.resolve();let y=!1;const b=[],k=[],w=[];function P(e){k.push(e)}function N(){const e=new Set;do{for(;m.length;){const e=m.shift();p(e),x(e.$$)}for(;b.length;)b.shift()();for(;k.length;){const t=k.pop();e.has(t)||(t(),e.add(t))}}while(m.length);for(;w.length;)w.pop()();y=!1}function x(e){e.fragment&&(e.update(e.dirty),l(e.before_render),e.fragment.p(e.dirty,e.ctx),e.dirty=null,e.after_render.forEach(P))}let D;function V(){D={remaining:0,callbacks:[]}}function _(){D.remaining||l(D.callbacks)}function E(e){D.callbacks.push(e)}function A(e,n,r){const{fragment:o,on_mount:c,on_destroy:s,after_render:a}=e.$$;o.m(n,r),P(()=>{const n=c.map(t).filter(i);s?s.push(...n):l(n),e.$$.on_mount=[]}),a.forEach(P)}function I(e,t){e.$$.dirty||(m.push(e),y||(y=!0,$.then(N)),e.$$.dirty=n()),e.$$.dirty[t]=!0}function C(t,i,r,o,c,s){const a=v;p(t);const u=i.props||{},f=t.$$={fragment:null,ctx:null,props:s,update:e,not_equal:c,bound:n(),on_mount:[],on_destroy:[],before_render:[],after_render:[],context:new Map(a?a.$$.context:[]),callbacks:n(),dirty:null};let d=!1;var h;f.ctx=r?r(t,u,(e,n)=>{f.ctx&&c(f.ctx[e],f.ctx[e]=n)&&(f.bound[e]&&f.bound[e](n),d&&I(t,e))}):u,f.update(),d=!0,l(f.before_render),f.fragment=o(f.ctx),i.target&&(i.hydrate?f.fragment.l((h=i.target,Array.from(h.childNodes))):f.fragment.c(),i.intro&&t.$$.fragment.i&&t.$$.fragment.i(),A(t,i.target,i.anchor),N()),p(a)}class B{$destroy(){var t,n;n=!0,(t=this).$$&&(l(t.$$.on_destroy),t.$$.fragment.d(n),t.$$.on_destroy=t.$$.fragment=null,t.$$.ctx={}),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}function M(e,t,n){const l=Object.create(e);return l.level=t[n],l}function O(e){var t,n,l,i,r=e.levelText[e.level];function a(){return e.click_handler(e)}return{c(){t=u("li"),n=f(r),t.className=l=(e.level===e.selectedDifficult?"active":"")+" svelte-k3hw74",i=h(t,"click",a)},m(e,l){c(e,t,l),o(t,n)},p(n,i){e=i,n.selectedDifficult&&l!==(l=(e.level===e.selectedDifficult?"active":"")+" svelte-k3hw74")&&(t.className=l)},d(e){e&&s(t),i()}}}function G(e){var t;return{c(){(t=u("p")).textContent="Victory :)",t.className="victory svelte-k3hw74"},m(e,n){c(e,t,n)},d(e){e&&s(t)}}}function W(t){for(var n,l,i,r,f,h,v,p=t.levels,g=[],m=0;m<p.length;m+=1)g[m]=O(M(t,p,m));var $=t.isVictory&&G();return{c(){n=u("div"),(l=u("h1")).textContent="Change level",i=d(),r=u("ul");for(var e=0;e<g.length;e+=1)g[e].c();f=d(),(h=u("div")).innerHTML='<h2 class="svelte-k3hw74">Hints</h2>\n\t\t\t    <ul><li class="svelte-k3hw74">Arrow keys navigate through the cells.</li>\n\t\t\t      <li class="svelte-k3hw74">Number 0 erase a cell.</li>\n\t\t\t      <li class="svelte-k3hw74">Ctrl + number fill a cell using a pencil.</li></ul>',v=d(),$&&$.c(),l.className="svelte-k3hw74",r.className="level-menu svelte-k3hw74",h.className="hint-container svelte-k3hw74",n.className="container svelte-k3hw74"},m(e,t){c(e,n,t),o(n,l),o(n,i),o(n,r);for(var s=0;s<g.length;s+=1)g[s].m(r,null);o(n,f),o(n,h),o(n,v),$&&$.m(n,null)},p(e,t){if(e.levels||e.selectedDifficult||e.levelText){p=t.levels;for(var l=0;l<p.length;l+=1){const n=M(t,p,l);g[l]?g[l].p(e,n):(g[l]=O(n),g[l].c(),g[l].m(r,null))}for(;l<g.length;l+=1)g[l].d(1);g.length=p.length}t.isVictory?$||(($=G()).c(),$.m(n,null)):$&&($.d(1),$=null)},i:e,o:e,d(e){e&&s(n),a(g,e),$&&$.d()}}}function j(e,t,n){let{isVictory:l,selectedDifficult:i}=t;const r=g(),o=e=>{r("change-difficult",e)};return e.$set=(e=>{"isVictory"in e&&n("isVictory",l=e.isVictory),"selectedDifficult"in e&&n("selectedDifficult",i=e.selectedDifficult)}),{isVictory:l,selectedDifficult:i,handleChange:o,levels:["easy","medium","hard","veryHard","insane"],levelText:{easy:"Easy",medium:"Medium",hard:"Hard",veryHard:"Very hard",insane:"Insane"},click_handler:function({level:e}){return o(e)}}}class q extends B{constructor(e){super(),C(this,e,j,W,r,["isVictory","selectedDifficult"])}}function H(e,t,n){const l=Object.create(e);return l.option=t[n],l}function T(e){for(var t,n=e.options,l=[],i=0;i<n.length;i+=1)l[i]=L(H(e,n,i));return{c(){t=u("ul");for(var e=0;e<l.length;e+=1)l[e].c();t.className="pencil-container svelte-1iw8hsv"},m(e,n){c(e,t,n);for(var i=0;i<l.length;i+=1)l[i].m(t,null)},p(e,i){if(e.options||e.cell){n=i.options;for(var r=0;r<n.length;r+=1){const o=H(i,n,r);l[r]?l[r].p(e,o):(l[r]=L(o),l[r].c(),l[r].m(t,null))}for(;r<l.length;r+=1)l[r].d(1);l.length=n.length}},d(e){e&&s(t),a(l,e)}}}function L(e){var t,n,l,i,r=e.option;return{c(){t=u("li"),n=f(r),l=d(),t.className=i=`option option${e.option} ${e.cell.pencil.has(e.option)?"visibleOption":""}`+" svelte-1iw8hsv"},m(e,i){c(e,t,i),o(t,n),o(t,l)},p(e,n){e.cell&&i!==(i=`option option${n.option} ${n.cell.pencil.has(n.option)?"visibleOption":""}`+" svelte-1iw8hsv")&&(t.className=i)},d(e){e&&s(t)}}}function S(t){var n,i,r,a,f,v,p=!t.cell.value&&T(t);return{c(){var e,l,o,c;n=u("div"),i=u("input"),f=d(),p&&p.c(),i.className=r=`${t.cell.error?"hasError":""} ${t.cell.position===t.activePosition?"keyboardActive":""}`+" svelte-1iw8hsv",i.disabled=a=t.cell.readonly,e=i,l="type",null==(o="text")?e.removeAttribute(l):e.setAttribute(l,o),n.className="container svelte-1iw8hsv",v=[h(i,"input",t.input_input_handler),h(i,"keydown",(c=t.handleChange,function(e){return e.preventDefault(),c.call(this,e)})),h(n,"click",t.putFocus)]},m(e,l){c(e,n,l),o(n,i),i.value=t.cell.value,o(n,f),p&&p.m(n,null)},p(e,t){e.cell&&i.value!==t.cell.value&&(i.value=t.cell.value),(e.cell||e.activePosition)&&r!==(r=`${t.cell.error?"hasError":""} ${t.cell.position===t.activePosition?"keyboardActive":""}`+" svelte-1iw8hsv")&&(i.className=r),e.cell&&a!==(a=t.cell.readonly)&&(i.disabled=a),t.cell.value?p&&(p.d(1),p=null):p?p.p(e,t):((p=T(t)).c(),p.m(n,null))},i:e,o:e,d(e){e&&s(n),p&&p.d(),l(v)}}}function F(e,t,n){let{cell:l,activePosition:i}=t;const r=g();return e.$set=(e=>{"cell"in e&&n("cell",l=e.cell),"activePosition"in e&&n("activePosition",i=e.activePosition)}),{cell:l,activePosition:i,options:[1,2,3,4,5,6,7,8,9],handleChange:e=>{const t=parseInt(e.key),n=e.ctrlKey;Number.isInteger(t)&&r(n?"pencil":"pen",{value:parseInt(t,10),position:l.position})},putFocus:e=>{e.currentTarget.querySelector("input").focus()},input_input_handler:function(){l.value=this.value,n("cell",l)}}}class K extends B{constructor(e){super(),C(this,e,F,S,r,["cell","activePosition"])}}const z=[Array(2).fill([1,1,2,2]),Array(2).fill([3,3,4,4])].flat(2),R=[Array(3).fill([1,1,1,2,2,2,3,3,3]),Array(3).fill([4,4,4,5,5,5,6,6,6]),Array(3).fill([7,7,7,8,8,8,9,9,9])].flat(2),U=(e=3)=>{return Array(3===e?81:16).fill(0)},J=e=>{for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e},Q=(e,t=3)=>{const n=3===t?9:4,l=[];let i=0,r=e[i],o=J([1,2,3,4,5,6,7,8,9]),c=0;for(;ne(e);)0===r?te(e,i,o[c],t)&&c<n?(e[i]=o[c],l.push(i),o=J([1,2,3,4,5,6,7,8,9]),c=-1,r=e[i+=1]):c>n-1&&(e[i]=0,i=l.pop(),c=o.indexOf(e[i]),e[i]=0):(r=e[i+=1],o=J([1,2,3,4,5,6,7,8,9]),c=-1),c+=1;return e},X=(e,t=3)=>{const n=3===t?R:z;return e.map((e,t)=>({value:e,block:n[t],position:t,readonly:!!e,pencil:new Set}))},Y=e=>e.reduce((e,t)=>{const n=t.block-1;return e[n]?e[n].push(t):e[n]=[t],e},[]),Z={easy:62,medium:53,hard:44,veryHard:35,insane:26},ee=(e,t)=>{const n=new Set;for(;n.size!==81-Z[e];){const e=Math.floor(81*Math.random());n.add(e)}for(const e of n)t[e]=null;return t},te=(e,t,n,l=3)=>{const i=new Set,r=3===l?9:4,o=3===l?R:z,c=Math.floor(t/r);e.forEach((e,t)=>{Math.floor(t/r)===c&&i.add(e)});const s=t%r;e.forEach((e,t)=>{Math.floor(t%r)===s&&i.add(e)});const a=o[t];return e.forEach((e,t)=>{o[t]===a&&i.add(e)}),!i.has(n)},ne=e=>0!==e.filter(e=>0===e).length,le=e=>e.filter(e=>e.error).length,ie=(e,t)=>e.filter(e=>null===e.value).length+t,re=(e,t)=>{const n=parseInt(e,10);return"ArrowDown"===e&&t<72?[!0,"down"]:"ArrowUp"===e&&t>8?[!0,"up"]:"ArrowLeft"===e&&t%9>0?[!0,"left"]:"ArrowRight"===e&&t%9<8?[!0,"right"]:Number.isInteger(n)?[!0,"digit"]:[!1,null]},oe=(e,t)=>"down"===t?e+9:"up"===t?e-9:"left"===t?e-1:"right"===t?e+1:void 0;function ce(e,t,n){const l=Object.create(e);return l.cell=t[n],l}function se(e,t,n){const l=Object.create(e);return l.block=t[n],l}function ae(e){var t,n,l=new K({props:{cell:e.cell,activePosition:e.activePosition}});return l.$on("pen",e.handlePen),l.$on("pencil",e.handlePencil),{c(){t=u("div"),l.$$.fragment.c(),t.className="cell svelte-1lnq6b1"},m(e,i){c(e,t,i),A(l,t,null),n=!0},p(e,t){var n={};e.groupedGrid&&(n.cell=t.cell),e.activePosition&&(n.activePosition=t.activePosition),l.$set(n)},i(e){n||(l.$$.fragment.i(e),n=!0)},o(e){l.$$.fragment.o(e),n=!1},d(e){e&&s(t),l.$destroy()}}}function ue(e){for(var t,n,l,i=e.block,r=[],f=0;f<i.length;f+=1)r[f]=ae(ce(e,i,f));function h(e,t,n){r[e]&&(t&&E(()=>{r[e].d(t),r[e]=null}),r[e].o(n))}return{c(){t=u("div");for(var e=0;e<r.length;e+=1)r[e].c();n=d(),t.className="block svelte-1lnq6b1"},m(e,i){c(e,t,i);for(var s=0;s<r.length;s+=1)r[s].m(t,null);o(t,n),l=!0},p(e,l){if(e.groupedGrid||e.activePosition||e.handlePen||e.handlePencil){i=l.block;for(var o=0;o<i.length;o+=1){const c=ce(l,i,o);r[o]?(r[o].p(e,c),r[o].i(1)):(r[o]=ae(c),r[o].c(),r[o].i(1),r[o].m(t,n))}for(V();o<r.length;o+=1)h(o,1,1);_()}},i(e){if(!l){for(var t=0;t<i.length;t+=1)r[t].i();l=!0}},o(e){r=r.filter(Boolean);for(let e=0;e<r.length;e+=1)h(e,0,0);l=!1},d(e){e&&s(t),a(r,e)}}}function fe(e){var t,n,l,i,r=new q({props:{isVictory:e.isVictory,selectedDifficult:e.selectedDifficult}});r.$on("change-difficult",e.handleChangeDifficult);for(var f=e.groupedGrid,h=[],v=0;v<f.length;v+=1)h[v]=ue(se(e,f,v));function p(e,t,n){h[e]&&(t&&E(()=>{h[e].d(t),h[e]=null}),h[e].o(n))}return{c(){t=u("div"),r.$$.fragment.c(),n=d(),l=u("div");for(var e=0;e<h.length;e+=1)h[e].c();l.className="grid svelte-1lnq6b1",t.className="container svelte-1lnq6b1"},m(e,s){c(e,t,s),A(r,t,null),o(t,n),o(t,l);for(var a=0;a<h.length;a+=1)h[a].m(l,null);i=!0},p(e,t){var n={};if(e.isVictory&&(n.isVictory=t.isVictory),e.selectedDifficult&&(n.selectedDifficult=t.selectedDifficult),r.$set(n),e.groupedGrid||e.activePosition||e.handlePen||e.handlePencil){f=t.groupedGrid;for(var i=0;i<f.length;i+=1){const n=se(t,f,i);h[i]?(h[i].p(e,n),h[i].i(1)):(h[i]=ue(n),h[i].c(),h[i].i(1),h[i].m(l,null))}for(V();i<h.length;i+=1)p(i,1,1);_()}},i(e){if(!i){r.$$.fragment.i(e);for(var t=0;t<f.length;t+=1)h[t].i();i=!0}},o(e){r.$$.fragment.o(e),h=h.filter(Boolean);for(let e=0;e<h.length;e+=1)p(e,0,0);i=!1},d(e){e&&s(t),r.$destroy(),a(h,e)}}}function de(e,t,n){let l,i,r="hard",o=0;const c=e=>{const t=U(3),o=Q(t,3);l=ee(r,o),n("gridWithBlockInfo",i=X(l,3))},s=({detail:{value:e,position:t}})=>{const r=te(l,t,e);n("gridWithBlockInfo",i=i.map(n=>n.position!==t?n:{...n,value:0!==e?e:null,error:!r})),l[t]=e},a=({detail:{value:e,position:t}})=>{0!==e&&n("gridWithBlockInfo",i=i.map(n=>{if(n.position!==t)return n;return n.pencil.has(e)?n.pencil.delete(e):n.pencil.add(e),n}))};let u,f,d,h;return c(),window.addEventListener("keydown",e=>{e.preventDefault();const{key:t,ctrlKey:l}=e,[r,c]=re(t,o);if(r)if("digit"!==c)n("activePosition",o=oe(o,c));else{if(i[o].readonly)return;const e={detail:{value:parseInt(t,10),position:o}};l?a(e):s(e)}}),e.$$.update=((e={gridWithBlockInfo:1,errors:1,missingValues:1})=>{e.gridWithBlockInfo&&n("groupedGrid",u=Y(i)),e.gridWithBlockInfo&&n("errors",f=le(i)),(e.gridWithBlockInfo||e.errors)&&n("missingValues",d=ie(i,f)),e.missingValues&&n("isVictory",h=0===d)}),{selectedDifficult:r,activePosition:o,handlePen:s,handlePencil:a,handleChangeDifficult:({detail:e})=>{n("selectedDifficult",r=e),c()},groupedGrid:u,isVictory:h}}return new class extends B{constructor(e){super(),C(this,e,de,fe,r,[])}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
