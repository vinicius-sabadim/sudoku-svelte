var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function l(e){e.forEach(t)}function r(e){return"function"==typeof e}function i(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function o(e,t){e.appendChild(t)}function c(e,t,n){e.insertBefore(t,n||null)}function a(e){e.parentNode.removeChild(e)}function s(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function u(e){return document.createElement(e)}function f(e){return document.createTextNode(e)}function d(){return f(" ")}function v(e,t,n,l){return e.addEventListener(t,n,l),()=>e.removeEventListener(t,n,l)}let h;function p(e){h=e}function g(){const e=h;return(t,n)=>{const l=e.$$.callbacks[t];if(l){const r=function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(t,n);l.slice().forEach(t=>{t.call(e,r)})}}}const m=[],y=Promise.resolve();let $=!1;const b=[],k=[],C=[];function w(e){k.push(e)}function U(){const e=new Set;do{for(;m.length;){const e=m.shift();p(e),K(e.$$)}for(;b.length;)b.shift()();for(;k.length;){const t=k.pop();e.has(t)||(t(),e.add(t))}}while(m.length);for(;C.length;)C.pop()();$=!1}function K(e){e.fragment&&(e.update(e.dirty),l(e.before_render),e.fragment.p(e.dirty,e.ctx),e.dirty=null,e.after_render.forEach(w))}let x;function D(){x={remaining:0,callbacks:[]}}function N(){x.remaining||l(x.callbacks)}function V(e){x.callbacks.push(e)}function _(e,n,i){const{fragment:o,on_mount:c,on_destroy:a,after_render:s}=e.$$;o.m(n,i),w(()=>{const n=c.map(t).filter(r);a?a.push(...n):l(n),e.$$.on_mount=[]}),s.forEach(w)}function E(e,t){e.$$.dirty||(m.push(e),$||($=!0,y.then(U)),e.$$.dirty=n()),e.$$.dirty[t]=!0}function j(t,r,i,o,c,a){const s=h;p(t);const u=r.props||{},f=t.$$={fragment:null,ctx:null,props:a,update:e,not_equal:c,bound:n(),on_mount:[],on_destroy:[],before_render:[],after_render:[],context:new Map(s?s.$$.context:[]),callbacks:n(),dirty:null};let d=!1;var v;f.ctx=i?i(t,u,(e,n)=>{f.ctx&&c(f.ctx[e],f.ctx[e]=n)&&(f.bound[e]&&f.bound[e](n),d&&E(t,e))}):u,f.update(),d=!0,l(f.before_render),f.fragment=o(f.ctx),r.target&&(r.hydrate?f.fragment.l((v=r.target,Array.from(v.childNodes))):f.fragment.c(),r.intro&&t.$$.fragment.i&&t.$$.fragment.i(),_(t,r.target,r.anchor),U()),p(s)}class q{$destroy(){var t,n;n=!0,(t=this).$$&&(l(t.$$.on_destroy),t.$$.fragment.d(n),t.$$.on_destroy=t.$$.fragment=null,t.$$.ctx={}),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}function A(e,t,n){const l=Object.create(e);return l.level=t[n],l}function I(e){var t,n,l,r,i=e.levelText[e.level];function s(){return e.click_handler(e)}return{c(){t=u("li"),n=f(i),t.className=l=(e.level===e.selectedDifficult?"active":"")+" svelte-rk9qj4",r=v(t,"click",s)},m(e,l){c(e,t,l),o(t,n)},p(n,r){e=r,n.selectedDifficult&&l!==(l=(e.level===e.selectedDifficult?"active":"")+" svelte-rk9qj4")&&(t.className=l)},d(e){e&&a(t),r()}}}function B(e){var t;return{c(){(t=u("p")).textContent="Victory :)",t.className="victory svelte-rk9qj4"},m(e,n){c(e,t,n)},d(e){e&&a(t)}}}function M(t){for(var n,l,r,i,f,v,h,p=t.levels,g=[],m=0;m<p.length;m+=1)g[m]=I(A(t,p,m));var y=t.isVictory&&B();return{c(){n=u("div"),(l=u("h1")).textContent="Change level",r=d(),i=u("ul");for(var e=0;e<g.length;e+=1)g[e].c();f=d(),(v=u("div")).innerHTML='<h2 class="svelte-rk9qj4">Hints</h2>\n\t\t\t    <ul><li class="svelte-rk9qj4">Use the number 0 to erase a cell.</li>\n\t\t\t      <li class="svelte-rk9qj4">Use ctrl + number to fill a cell using a pencil.</li></ul>',h=d(),y&&y.c(),l.className="svelte-rk9qj4",i.className="level-menu svelte-rk9qj4",v.className="hint-container svelte-rk9qj4",n.className="container svelte-rk9qj4"},m(e,t){c(e,n,t),o(n,l),o(n,r),o(n,i);for(var a=0;a<g.length;a+=1)g[a].m(i,null);o(n,f),o(n,v),o(n,h),y&&y.m(n,null)},p(e,t){if(e.levels||e.selectedDifficult||e.levelText){p=t.levels;for(var l=0;l<p.length;l+=1){const n=A(t,p,l);g[l]?g[l].p(e,n):(g[l]=I(n),g[l].c(),g[l].m(i,null))}for(;l<g.length;l+=1)g[l].d(1);g.length=p.length}t.isVictory?y||((y=B()).c(),y.m(n,null)):y&&(y.d(1),y=null)},i:e,o:e,d(e){e&&a(n),s(g,e),y&&y.d()}}}function O(e,t,n){let{isVictory:l,selectedDifficult:r}=t;const i=g(),o=e=>{i("change-difficult",e)};return e.$set=(e=>{"isVictory"in e&&n("isVictory",l=e.isVictory),"selectedDifficult"in e&&n("selectedDifficult",r=e.selectedDifficult)}),{isVictory:l,selectedDifficult:r,handleChange:o,levels:["easy","medium","hard","veryHard","insane"],levelText:{easy:"Easy",medium:"Medium",hard:"Hard",veryHard:"Very hard",insane:"Insane"},click_handler:function({level:e}){return o(e)}}}class P extends q{constructor(e){super(),j(this,e,O,M,i,["isVictory","selectedDifficult"])}}function G(e,t,n){const l=Object.create(e);return l.option=t[n],l}function W(e){for(var t,n=e.options,l=[],r=0;r<n.length;r+=1)l[r]=H(G(e,n,r));return{c(){t=u("ul");for(var e=0;e<l.length;e+=1)l[e].c();t.className="pencil-container svelte-1iw8hsv"},m(e,n){c(e,t,n);for(var r=0;r<l.length;r+=1)l[r].m(t,null)},p(e,r){if(e.options||e.cell){n=r.options;for(var i=0;i<n.length;i+=1){const o=G(r,n,i);l[i]?l[i].p(e,o):(l[i]=H(o),l[i].c(),l[i].m(t,null))}for(;i<l.length;i+=1)l[i].d(1);l.length=n.length}},d(e){e&&a(t),s(l,e)}}}function H(e){var t,n,l,r,i=e.option;return{c(){t=u("li"),n=f(i),l=d(),t.className=r=`option option${e.option} ${e.cell.pencil.has(e.option)?"visibleOption":""}`+" svelte-1iw8hsv"},m(e,r){c(e,t,r),o(t,n),o(t,l)},p(e,n){e.cell&&r!==(r=`option option${n.option} ${n.cell.pencil.has(n.option)?"visibleOption":""}`+" svelte-1iw8hsv")&&(t.className=r)},d(e){e&&a(t)}}}function T(t){var n,r,i,s,f,h,p=!t.cell.value&&W(t);return{c(){var e,l,o,c;n=u("div"),r=u("input"),f=d(),p&&p.c(),r.className=i=`${t.cell.error?"hasError":""} ${t.cell.position===t.activeCellUsingKeyboard?"keyboardActive":""}`+" svelte-1iw8hsv",r.disabled=s=t.cell.readonly,e=r,l="type",null==(o="text")?e.removeAttribute(l):e.setAttribute(l,o),n.className="container svelte-1iw8hsv",h=[v(r,"input",t.input_input_handler),v(r,"keydown",(c=t.handleChange,function(e){return e.preventDefault(),c.call(this,e)})),v(n,"click",t.putFocus)]},m(e,l){c(e,n,l),o(n,r),r.value=t.cell.value,o(n,f),p&&p.m(n,null)},p(e,t){e.cell&&r.value!==t.cell.value&&(r.value=t.cell.value),(e.cell||e.activeCellUsingKeyboard)&&i!==(i=`${t.cell.error?"hasError":""} ${t.cell.position===t.activeCellUsingKeyboard?"keyboardActive":""}`+" svelte-1iw8hsv")&&(r.className=i),e.cell&&s!==(s=t.cell.readonly)&&(r.disabled=s),t.cell.value?p&&(p.d(1),p=null):p?p.p(e,t):((p=W(t)).c(),p.m(n,null))},i:e,o:e,d(e){e&&a(n),p&&p.d(),l(h)}}}function L(e,t,n){let{cell:l,activeCellUsingKeyboard:r}=t;const i=g();return e.$set=(e=>{"cell"in e&&n("cell",l=e.cell),"activeCellUsingKeyboard"in e&&n("activeCellUsingKeyboard",r=e.activeCellUsingKeyboard)}),{cell:l,activeCellUsingKeyboard:r,options:[1,2,3,4,5,6,7,8,9],handleChange:e=>{const t=parseInt(e.key),n=e.ctrlKey;Number.isInteger(t)&&i(n?"pencil":"pen",{value:parseInt(t,10),position:l.position})},putFocus:e=>{e.currentTarget.querySelector("input").focus()},input_input_handler:function(){l.value=this.value,n("cell",l)}}}class S extends q{constructor(e){super(),j(this,e,L,T,i,["cell","activeCellUsingKeyboard"])}}const F=[Array(2).fill([1,1,2,2]),Array(2).fill([3,3,4,4])].flat(2),z=[Array(3).fill([1,1,1,2,2,2,3,3,3]),Array(3).fill([4,4,4,5,5,5,6,6,6]),Array(3).fill([7,7,7,8,8,8,9,9,9])].flat(2),R=(e=3)=>{return Array(3===e?81:16).fill(0)},J=e=>{for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e},Q=(e,t=3)=>{const n=3===t?9:4,l=[];let r=0,i=e[r],o=J([1,2,3,4,5,6,7,8,9]),c=0;for(;ne(e);)0===i?te(e,r,o[c],t)&&c<n?(e[r]=o[c],l.push(r),o=J([1,2,3,4,5,6,7,8,9]),c=-1,i=e[r+=1]):c>n-1&&(e[r]=0,r=l.pop(),c=o.indexOf(e[r]),e[r]=0):(i=e[r+=1],o=J([1,2,3,4,5,6,7,8,9]),c=-1),c+=1;return e},X=(e,t=3)=>{const n=3===t?z:F;return e.map((e,t)=>({value:e,block:n[t],position:t,readonly:!!e,pencil:new Set}))},Y=e=>e.reduce((e,t)=>{const n=t.block-1;return e[n]?e[n].push(t):e[n]=[t],e},[]),Z={easy:62,medium:53,hard:44,veryHard:35,insane:26},ee=(e,t)=>{const n=new Set;for(;n.size!==81-Z[e];){const e=Math.floor(81*Math.random());n.add(e)}for(const e of n)t[e]=null;return t},te=(e,t,n,l=3)=>{const r=new Set,i=3===l?9:4,o=3===l?z:F,c=Math.floor(t/i);e.forEach((e,t)=>{Math.floor(t/i)===c&&r.add(e)});const a=t%i;e.forEach((e,t)=>{Math.floor(t%i)===a&&r.add(e)});const s=o[t];return e.forEach((e,t)=>{o[t]===s&&r.add(e)}),!r.has(n)},ne=e=>0!==e.filter(e=>0===e).length,le=e=>e.filter(e=>e.error).length,re=(e,t)=>e.filter(e=>null===e.value).length+t;function ie(e,t,n){const l=Object.create(e);return l.cell=t[n],l}function oe(e,t,n){const l=Object.create(e);return l.block=t[n],l}function ce(e){var t,n,l=new S({props:{cell:e.cell,activeCellUsingKeyboard:e.activeCellUsingKeyboard}});return l.$on("pen",e.handlePen),l.$on("pencil",e.handlePencil),{c(){t=u("div"),l.$$.fragment.c(),t.className="cell svelte-1lnq6b1"},m(e,r){c(e,t,r),_(l,t,null),n=!0},p(e,t){var n={};e.groupedGrid&&(n.cell=t.cell),e.activeCellUsingKeyboard&&(n.activeCellUsingKeyboard=t.activeCellUsingKeyboard),l.$set(n)},i(e){n||(l.$$.fragment.i(e),n=!0)},o(e){l.$$.fragment.o(e),n=!1},d(e){e&&a(t),l.$destroy()}}}function ae(e){for(var t,n,l,r=e.block,i=[],f=0;f<r.length;f+=1)i[f]=ce(ie(e,r,f));function v(e,t,n){i[e]&&(t&&V(()=>{i[e].d(t),i[e]=null}),i[e].o(n))}return{c(){t=u("div");for(var e=0;e<i.length;e+=1)i[e].c();n=d(),t.className="block svelte-1lnq6b1"},m(e,r){c(e,t,r);for(var a=0;a<i.length;a+=1)i[a].m(t,null);o(t,n),l=!0},p(e,l){if(e.groupedGrid||e.activeCellUsingKeyboard||e.handlePen||e.handlePencil){r=l.block;for(var o=0;o<r.length;o+=1){const c=ie(l,r,o);i[o]?(i[o].p(e,c),i[o].i(1)):(i[o]=ce(c),i[o].c(),i[o].i(1),i[o].m(t,n))}for(D();o<i.length;o+=1)v(o,1,1);N()}},i(e){if(!l){for(var t=0;t<r.length;t+=1)i[t].i();l=!0}},o(e){i=i.filter(Boolean);for(let e=0;e<i.length;e+=1)v(e,0,0);l=!1},d(e){e&&a(t),s(i,e)}}}function se(e){var t,n,l,r,i=new P({props:{isVictory:e.isVictory,selectedDifficult:e.selectedDifficult}});i.$on("change-difficult",e.handleChangeDifficult);for(var f=e.groupedGrid,v=[],h=0;h<f.length;h+=1)v[h]=ae(oe(e,f,h));function p(e,t,n){v[e]&&(t&&V(()=>{v[e].d(t),v[e]=null}),v[e].o(n))}return{c(){t=u("div"),i.$$.fragment.c(),n=d(),l=u("div");for(var e=0;e<v.length;e+=1)v[e].c();l.className="grid svelte-1lnq6b1",t.className="container svelte-1lnq6b1"},m(e,a){c(e,t,a),_(i,t,null),o(t,n),o(t,l);for(var s=0;s<v.length;s+=1)v[s].m(l,null);r=!0},p(e,t){var n={};if(e.isVictory&&(n.isVictory=t.isVictory),e.selectedDifficult&&(n.selectedDifficult=t.selectedDifficult),i.$set(n),e.groupedGrid||e.activeCellUsingKeyboard||e.handlePen||e.handlePencil){f=t.groupedGrid;for(var r=0;r<f.length;r+=1){const n=oe(t,f,r);v[r]?(v[r].p(e,n),v[r].i(1)):(v[r]=ae(n),v[r].c(),v[r].i(1),v[r].m(l,null))}for(D();r<v.length;r+=1)p(r,1,1);N()}},i(e){if(!r){i.$$.fragment.i(e);for(var t=0;t<f.length;t+=1)v[t].i();r=!0}},o(e){i.$$.fragment.o(e),v=v.filter(Boolean);for(let e=0;e<v.length;e+=1)p(e,0,0);r=!1},d(e){e&&a(t),i.$destroy(),s(v,e)}}}function ue(e,t,n){let l,r,i="hard",o=0;const c=e=>{const t=R(3),o=Q(t,3);l=ee(i,o),n("gridWithBlockInfo",r=X(l,3))},a=({detail:{value:e,position:t}})=>{const i=te(l,t,e);n("gridWithBlockInfo",r=r.map(n=>n.position!==t?n:{...n,value:0!==e?e:null,error:!i})),l[t]=e},s=({detail:{value:e,position:t}})=>{0!==e&&n("gridWithBlockInfo",r=r.map(n=>{if(n.position!==t)return n;return n.pencil.has(e)?n.pencil.delete(e):n.pencil.add(e),n}))};let u,f,d,v;return c(),window.addEventListener("keydown",e=>{e.preventDefault();const{key:t,code:l,ctrlKey:i}=e,c=r[o],u=parseInt(t,10);if("ArrowDown"===l&&o<72)n("activeCellUsingKeyboard",o+=9);else if("ArrowUp"===l&&o>8)n("activeCellUsingKeyboard",o-=9);else if("ArrowLeft"===l&&o%9>0)n("activeCellUsingKeyboard",o-=1);else if("ArrowRight"===l&&o%9<8)n("activeCellUsingKeyboard",o+=1);else if(Number.isInteger(u)){if(c.readonly)return;const e={detail:{value:parseInt(t,10),position:o}};i?s(e):a(e)}}),e.$$.update=((e={gridWithBlockInfo:1,errors:1,missingValues:1})=>{e.gridWithBlockInfo&&n("groupedGrid",u=Y(r)),e.gridWithBlockInfo&&n("errors",f=le(r)),(e.gridWithBlockInfo||e.errors)&&n("missingValues",d=re(r,f)),e.missingValues&&n("isVictory",v=0===d)}),{selectedDifficult:i,activeCellUsingKeyboard:o,handlePen:a,handlePencil:s,handleChangeDifficult:({detail:e})=>{n("selectedDifficult",i=e),c()},groupedGrid:u,isVictory:v}}return new class extends q{constructor(e){super(),j(this,e,ue,se,i,[])}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
